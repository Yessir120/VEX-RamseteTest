#include "main.h"

std::vector<std::vector<double>> path = {
        {0,0,0,0,0,0},
        {0.0004,0.0004,0.0364,0.0364,3.375,3.375},
        {0.001,0.001,0.0697,0.0697,3.5419,3.5419},
        {0.0022,0.0022,0.1141,0.1141,4.2962,4.2962},
        {0.0038,0.0038,0.1596,0.1596,4.6095,4.6095},
        {0.0058,0.0058,0.2035,0.2035,4.5457,4.5457},
        {0.0083,0.0083,0.2478,0.2478,4.4138,4.4138},
        {0.0113,0.0113,0.2935,0.2935,4.452,4.452},
        {0.0145,0.0145,0.3384,0.3384,4.637,4.637},
        {0.0185,0.0185,0.3832,0.3832,4.3741,4.3741},
        {0.0227,0.0227,0.4283,0.4283,4.6082,4.6082},
        {0.0274,0.0274,0.4727,0.4727,4.4583,4.4583},
        {0.0326,0.0326,0.5178,0.5178,4.4693,4.4693},
        {0.0382,0.0382,0.563,0.563,4.5267,4.5267},
        {0.0444,0.0444,0.6082,0.6082,4.4748,4.4748},
        {0.0509,0.0509,0.6534,0.6534,4.5234,4.5234},
        {0.0578,0.0578,0.6982,0.6982,4.5194,4.5194},
        {0.0652,0.0652,0.743,0.743,4.4777,4.4777},
        {0.0731,0.0731,0.7878,0.7878,4.518,4.518},
        {0.0814,0.0814,0.8327,0.8327,4.481,4.481},
        {0.0902,0.0902,0.8779,0.8779,4.4843,4.4843},
        {0.0995,0.0995,0.923,0.923,4.5176,4.5176},
        {0.1091,0.1091,0.9679,0.9679,4.5155,4.5155},
        {0.1192,0.1192,1.0127,1.0127,4.4854,4.4854},
        {0.1298,0.1298,1.0579,1.0579,4.4876,4.4876},
        {0.1409,0.1409,1.1029,1.1029,4.5152,4.5152},
        {0.1523,0.1523,1.1477,1.1477,4.5138,4.5138},
        {0.1643,0.1643,1.1928,1.1928,4.4648,4.4648},
        {0.1766,0.1766,1.2378,1.2378,4.5381,4.5381},
        {0.1895,0.1895,1.2827,1.2827,4.4675,4.4675},
        {0.2027,0.2027,1.3278,1.3278,4.5139,4.5139},
        {0.2164,0.2164,1.3727,1.3727,4.5129,4.5129},
        {0.2306,0.2306,1.4177,1.4177,4.4718,4.4718},
        {0.2452,0.2452,1.4627,1.4627,4.5332,4.5332},
        {0.2603,0.2603,1.5076,1.5076,4.4737,4.4737},
        {0.2758,0.2758,1.5526,1.5526,4.5128,4.5128},
        {0.2918,0.2918,1.5976,1.5976,4.4942,4.4942},
        {0.3083,0.3083,1.6427,1.6427,4.495,4.495},
        {0.3251,0.3251,1.6877,1.6877,4.5124,4.5124},
        {0.3424,0.3424,1.7326,1.7326,4.4954,4.4954},
        {0.3602,0.3602,1.7777,1.7777,4.496,4.496},
        {0.3784,0.3784,1.8226,1.8226,4.5121,4.5121},
        {0.3971,0.3971,1.8676,1.8676,4.4813,4.4813},
        {0.4162,0.4162,1.9127,1.9127,4.5123,4.5123},
        {0.4358,0.4358,1.9577,1.9577,4.4974,4.4974},
        {0.4558,0.4558,2.0027,2.0027,4.4978,4.4978},
        {0.4764,0.4764,2.0477,2.0477,4.4983,4.4983},
        {0.4972,0.4972,2.0927,2.0927,4.512,4.512},
        {0.5186,0.5186,2.1377,2.1377,4.4854,4.4854},
        {0.5404,0.5404,2.1827,2.1827,4.5122,4.5122},
        {0.5626,0.5626,2.2276,2.2276,4.4992,4.4992},
        {0.5855,0.5855,2.2726,2.2726,4.4873,4.4873},
        {0.6086,0.6086,2.3176,2.3176,4.5123,4.5123},
        {0.6322,0.6322,2.3626,2.3626,4.5001,4.5001},
        {0.6563,0.6563,2.4076,2.4076,4.489,4.489},
        {0.6808,0.6808,2.4526,2.4526,4.5124,4.5124},
        {0.7058,0.7058,2.4976,2.4976,4.4899,4.4899},
        {0.7313,0.7313,2.5426,2.5426,4.5016,4.5016},
        {0.7571,0.7571,2.5877,2.5877,4.5018,4.5018},
        {0.7835,0.7835,2.6327,2.6327,4.502,4.502},
        {0.8102,0.8102,2.6776,2.6776,4.5022,4.5022},
        {0.8375,0.8375,2.7226,2.7226,4.4924,4.4924},
        {0.865,0.865,2.7676,2.7676,4.5127,4.5127},
        {0.8933,0.8933,2.8126,2.8126,4.4835,4.4835},
        {0.9218,0.9218,2.8576,2.8576,4.513,4.513},
        {0.9508,0.9508,2.9026,2.9026,4.4941,4.4941},
        {0.9803,0.9803,2.9476,2.9476,4.5038,4.5038},
        {1.0102,1.0102,2.9926,2.9926,4.495,4.495},
        {1.0406,1.0406,3.0376,3.0376,4.5043,4.5043},
        {1.0714,1.0714,3.0826,3.0826,4.4958,4.4958},
        {1.1027,1.1027,3.1276,3.1276,4.5048,4.5048},
        {1.1344,1.1344,3.1726,3.1726,4.4966,4.4966},
        {1.1665,1.1665,3.2176,3.2176,4.5053,4.5053},
        {1.1993,1.1993,3.2626,3.2626,4.4893,4.4893},
        {1.2323,1.2323,3.3076,3.3076,4.5059,4.5059},
        {1.2658,1.2658,3.3526,3.3526,4.506,4.506},
        {1.2998,1.2998,3.3976,3.3976,4.4907,4.4907},
        {1.3342,1.3342,3.4426,3.4426,4.5066,4.5066},
        {1.3691,1.3691,3.4875,3.4875,4.4992,4.4992},
        {1.4045,1.4045,3.5326,3.5326,4.4923,4.4923},
        {1.4402,1.4402,3.5776,3.5776,4.5074,4.5074},
        {1.4764,1.4764,3.6226,3.6226,4.5003,4.5003},
        {1.5131,1.5131,3.6676,3.6676,4.5006,4.5006},
        {1.5502,1.5502,3.7126,3.7126,4.4941,4.4941},
        {1.5878,1.5878,3.7576,3.7576,4.5015,4.5015},
        {1.6258,1.6258,3.8026,3.8026,4.5084,4.5084},
        {1.6643,1.6643,3.8475,3.8475,4.4889,4.4889},
        {1.7032,1.7032,3.8926,3.8926,4.509,4.509},
        {1.7426,1.7426,3.9376,3.9376,4.49,4.49},
        {1.7824,1.7824,3.9826,3.9826,4.5095,4.5095},
        {1.8227,1.8227,4.0275,4.0275,4.4972,4.4972},
        {1.8634,1.8634,4.0725,4.0725,4.4977,4.4977},
        {1.9046,1.9046,4.1176,4.1176,4.4982,4.4982},
        {1.9462,1.9462,4.1626,4.1626,4.5045,4.5045},
        {1.9883,1.9883,4.2076,4.2076,4.499,4.499},
        {2.0308,2.0308,4.2526,4.2526,4.4994,4.4994},
        {2.0738,2.0738,4.2976,4.2976,4.4998,4.4998},
        {2.1172,2.1172,4.3426,4.3426,4.5003,4.5003},
        {2.1611,2.1611,4.3876,4.3876,4.5007,4.5007},
        {2.2054,2.2054,4.4326,4.4326,4.5011,4.5011},
        {2.2502,2.2502,4.4776,4.4776,4.4962,4.4962},
        {2.2952,2.2952,4.5,4.5,2.243,2.243},
        {2.3401,2.3401,4.5,4.5,0,0},
        {2.3852,2.3852,4.5,4.5,0,0},
        {2.4302,2.4302,4.5,4.5,0,0},
        {2.4752,2.4752,4.5,4.5,0,0},
        {2.5202,2.5202,4.5,4.5,0,0},
        {2.5652,2.5652,4.5,4.5,0,0},
        {2.6102,2.6102,4.5,4.5,0,0},
        {2.6552,2.6552,4.5,4.5,0,0},
        {2.7002,2.7002,4.5,4.5,0,0},
        {2.7452,2.7452,4.5,4.5,0,0},
        {2.7902,2.7902,4.5,4.5,0,0},
        {2.8352,2.8352,4.5,4.5,0,0},
        {2.8802,2.8802,4.5,4.5,0,0},
        {2.9251,2.9251,4.5,4.5,0,0},
        {2.9701,2.9701,4.5,4.5,0,0},
        {3.0152,3.0152,4.5,4.5,0,0},
        {3.0602,3.0602,4.5,4.5,0,0},
        {3.1052,3.1052,4.5,4.5,0,0},
        {3.1502,3.1502,4.5,4.5,0,0},
        {3.1952,3.1952,4.5,4.5,0,0},
        {3.2402,3.2402,4.5,4.5,0,0},
        {3.2852,3.2852,4.5,4.5,0,0},
        {3.3302,3.3302,4.5,4.5,0,0},
        {3.3751,3.3751,4.5,4.5,0,0},
        {3.4202,3.4202,4.5,4.5,0,0},
        {3.4652,3.4652,4.5,4.5,0,0},
        {3.5102,3.5102,4.5,4.5,0,0},
        {3.5551,3.5551,4.5,4.5,0,0},
        {3.6001,3.6001,4.5,4.5,0,0},
        {3.6452,3.6452,4.5,4.5,0,0},
        {3.6902,3.6902,4.5,4.5,0,0},
        {3.7352,3.7352,4.5,4.5,0,0},
        {3.7801,3.7801,4.5,4.5,0,0},
        {3.8252,3.8252,4.5,4.5,0,0},
        {3.8702,3.8702,4.5,4.5,0,0},
        {3.9151,3.9151,4.5,4.5,0,0},
        {3.9602,3.9602,4.5,4.5,0,0},
        {4.0052,4.0052,4.5,4.5,0,0},
        {4.0502,4.0502,4.5,4.5,0,0},
        {4.0952,4.0952,4.5,4.5,0,0},
        {4.1402,4.1402,4.5,4.5,0,0},
        {4.1851,4.1851,4.5,4.5,0,0},
        {4.2302,4.2302,4.5,4.5,0,0},
        {4.2752,4.2752,4.5,4.5,0,0},
        {4.3202,4.3202,4.5,4.5,0,0},
        {4.3652,4.3652,4.5,4.5,0,0},
        {4.4102,4.4102,4.5,4.5,0,0},
        {4.4551,4.4551,4.5,4.5,0,0},
        {4.5002,4.5002,4.5,4.5,0,0},
        {4.5452,4.5452,4.5,4.5,0,0},
        {4.5902,4.5902,4.5,4.5,0,0},
        {4.6352,4.6352,4.5,4.5,0,0},
        {4.6802,4.6802,4.5,4.5,0,0},
        {4.7252,4.7252,4.5,4.5,0,0},
        {4.7702,4.7702,4.5,4.5,0,0},
        {4.8152,4.8152,4.5,4.5,0,0},
        {4.8602,4.8602,4.5,4.5,0,0},
        {4.9052,4.9052,4.5,4.5,0,0},
        {4.9502,4.9502,4.5,4.5,0,0},
        {4.9952,4.9952,4.5,4.5,0,0},
        {5.0401,5.0401,4.5,4.5,0,0},
        {5.0851,5.0851,4.5,4.5,0,0},
        {5.1302,5.1302,4.5,4.5,0,0},
        {5.1751,5.1751,4.5,4.5,0,0},
        {5.2201,5.2201,4.5,4.5,0,0},
        {5.2652,5.2652,4.5,4.5,0,0},
        {5.3102,5.3102,4.5,4.5,0,0},
        {5.3551,5.3551,4.5,4.5,0,0},
        {5.4002,5.4002,4.5,4.5,0,0},
        {5.4452,5.4452,4.5,4.5,0,0},
        {5.4902,5.4902,4.5,4.5,0,0},
        {5.5352,5.5352,4.5,4.5,0,0},
        {5.5801,5.5801,4.5,4.5,0,0},
        {5.6252,5.6252,4.5,4.5,0,0},
        {5.6702,5.6702,4.5,4.5,0,0},
        {5.7152,5.7152,4.5,4.5,0,0},
        {5.7601,5.7601,4.4988,4.4988,-0.1188,-0.1188},
        {5.8048,5.8048,4.4672,4.4672,-3.1648,-3.1648},
        {5.8491,5.8491,4.4221,4.4221,-4.4985,-4.4985},
        {5.8928,5.8928,4.3771,4.3771,-4.5015,-4.5015},
        {5.9361,5.9361,4.3321,4.3321,-4.5012,-4.5012},
        {5.979,5.979,4.2871,4.2871,-4.4974,-4.4974},
        {6.0214,6.0214,4.2421,4.2421,-4.5038,-4.5038},
        {6.0634,6.0634,4.1972,4.1972,-4.4966,-4.4966},
        {6.1049,6.1049,4.1521,4.1521,-4.4996,-4.4996},
        {6.146,6.146,4.1071,4.1071,-4.5026,-4.5026},
        {6.1866,6.1866,4.0621,4.0621,-4.4988,-4.4988},
        {6.2268,6.2268,4.0171,4.0171,-4.4984,-4.4984},
        {6.2665,6.2665,3.9721,3.9721,-4.5014,-4.5014},
        {6.3058,6.3058,3.9271,3.9271,-4.501,-4.501},
        {6.3446,6.3446,3.8821,3.8821,-4.4971,-4.4971},
        {6.383,6.383,3.8371,3.8371,-4.5038,-4.5038},
        {6.4209,6.4209,3.7921,3.7921,-4.4962,-4.4962},
        {6.4584,6.4584,3.7471,3.7471,-4.5029,-4.5029},
        {6.4954,6.4954,3.7021,3.7021,-4.4989,-4.4989},
        {6.532,6.532,3.6571,3.6571,-4.4984,-4.4984},
        {6.5681,6.5681,3.6121,3.6121,-4.5017,-4.5017},
        {6.6037,6.6037,3.5672,3.5672,-4.5013,-4.5013},
        {6.639,6.639,3.5222,3.5222,-4.4971,-4.4971},
        {6.6738,6.6738,3.4771,3.4771,-4.5004,-4.5004},
        {6.7081,6.7081,3.4321,3.4321,-4.4999,-4.4999},
        {6.7419,6.7419,3.3871,3.3871,-4.5034,-4.5034},
        {6.7754,6.7754,3.3422,3.3422,-4.4952,-4.4952},
        {6.8083,6.8083,3.2971,3.2971,-4.5025,-4.5025},
        {6.8409,6.8409,3.2521,3.2521,-4.4981,-4.4981},
        {6.8729,6.8729,3.2071,3.2071,-4.5017,-4.5017},
        {6.9045,6.9045,3.1621,3.1621,-4.5013,-4.5013},
        {6.9357,6.9357,3.1171,3.1171,-4.4968,-4.4968},
        {6.9664,6.9664,3.0721,3.0721,-4.5045,-4.5045},
        {6.9967,6.9967,3.0272,3.0272,-4.4958,-4.4958},
        {7.0266,7.0266,2.9821,2.9821,-4.4995,-4.4995},
        {7.0559,7.0559,2.9371,2.9371,-4.5033,-4.5033},
        {7.0848,7.0848,2.8922,2.8922,-4.4987,-4.4987},
        {7.1133,7.1133,2.8471,2.8471,-4.4982,-4.4982},
        {7.1413,7.1413,2.8021,2.8021,-4.5022,-4.5022},
        {7.1689,7.1689,2.7571,2.7571,-4.4973,-4.4973},
        {7.196,7.196,2.7121,2.7121,-4.5014,-4.5014},
        {7.2227,7.2227,2.6671,2.6671,-4.501,-4.501},
        {7.2489,7.2489,2.6221,2.6221,-4.5006,-4.5006},
        {7.2747,7.2747,2.5772,2.5772,-4.5003,-4.5003},
        {7.3,7.3,2.5321,2.5321,-4.495,-4.495},
        {7.3249,7.3249,2.4871,2.4871,-4.5043,-4.5043},
        {7.3493,7.3493,2.4421,2.4421,-4.4991,-4.4991},
        {7.3733,7.3733,2.3971,2.3971,-4.4986,-4.4986},
        {7.3968,7.3968,2.3521,2.3521,-4.5034,-4.5034},
        {7.4199,7.4199,2.3071,2.3071,-4.4979,-4.4979},
        {7.4425,7.4425,2.2622,2.2622,-4.5028,-4.5028},
        {7.4646,7.4646,2.2172,2.2172,-4.4971,-4.4971},
        {7.4864,7.4864,2.1721,2.1721,-4.4966,-4.4966},
        {7.5076,7.5076,2.1271,2.1271,-4.5074,-4.5074},
        {7.5285,7.5285,2.0822,2.0822,-4.4959,-4.4959},
        {7.5488,7.5488,2.0372,2.0372,-4.5012,-4.5012},
        {7.5688,7.5688,1.9921,1.9921,-4.4949,-4.4949},
        {7.5882,7.5882,1.9471,1.9471,-4.5066,-4.5066},
        {7.6073,7.6073,1.9021,1.9021,-4.4941,-4.4941},
        {7.6258,7.6258,1.8571,1.8571,-4.5063,-4.5063},
        {7.6439,7.6439,1.8122,1.8122,-4.4998,-4.4998},
        {7.6616,7.6616,1.7671,1.7671,-4.4928,-4.4928},
        {7.6788,7.6788,1.7221,1.7221,-4.5058,-4.5058},
        {7.6956,7.6956,1.6771,1.6771,-4.4988,-4.4988},
        {7.7119,7.7119,1.6321,1.6321,-4.4984,-4.4984},
        {7.7278,7.7278,1.5871,1.5871,-4.5056,-4.5056},
        {7.7433,7.7433,1.5421,1.5421,-4.4903,-4.4903},
        {7.7582,7.7582,1.4971,1.4971,-4.5051,-4.5051},
        {7.7727,7.7727,1.4521,1.4521,-4.5053,-4.5053},
        {7.7868,7.7868,1.4071,1.4071,-4.4887,-4.4887},
        {7.8004,7.8004,1.3621,1.3621,-4.5135,-4.5135},
        {7.8136,7.8136,1.3171,1.3171,-4.4876,-4.4876},
        {7.8263,7.8263,1.2721,1.2721,-4.5047,-4.5047},
        {7.8386,7.8386,1.2271,1.2271,-4.505,-4.505},
        {7.8504,7.8504,1.1821,1.1821,-4.4952,-4.4952},
        {7.8618,7.8618,1.1371,1.1371,-4.4945,-4.4945},
        {7.8727,7.8727,1.0921,1.0921,-4.5154,-4.5154},
        {7.8832,7.8832,1.0471,1.0471,-4.4831,-4.4831},
        {7.8932,7.8932,1.002,1.002,-4.5042,-4.5042},
        {7.9028,7.9028,0.957,0.957,-4.5047,-4.5047},
        {7.9119,7.9119,0.9121,0.9121,-4.5052,-4.5052},
        {7.9206,7.9206,0.8671,0.8671,-4.492,-4.492},
        {7.9288,7.9288,0.8221,0.8221,-4.505,-4.505},
        {7.9366,7.9366,0.7771,0.7771,-4.4904,-4.4904},
        {7.9439,7.9439,0.732,0.732,-4.5047,-4.5047},
        {7.9507,7.9507,0.687,0.687,-4.5055,-4.5055},
        {7.9572,7.9572,0.642,0.642,-4.4878,-4.4878},
        {7.9632,7.9632,0.5969,0.5969,-4.5049,-4.5049},
        {7.9687,7.9687,0.5519,0.5519,-4.5059,-4.5059},
        {7.9737,7.9737,0.507,0.507,-4.5074,-4.5074},
        {7.9784,7.9784,0.462,0.462,-4.4832,-4.4832},
        {7.9825,7.9825,0.417,0.417,-4.5066,-4.5066},
        {7.9862,7.9862,0.3721,0.3721,-4.509,-4.509},
        {7.9895,7.9895,0.327,0.327,-4.4749,-4.4749},
        {7.9924,7.9924,0.2817,0.2817,-4.506,-4.506},
        {7.9947,7.9947,0.2366,0.2366,-4.5097,-4.5097},
        {7.9966,7.9966,0.1918,0.1918,-4.5173,-4.5173},
        {7.9981,7.9981,0.1465,0.1465,-4.4435,-4.4435},
        {7.9991,7.9991,0.1006,0.1006,-4.49,-4.49},
        {7.9997,7.9997,0.054,0.054,-4.4463,-4.4463}
    }
;


void initialize() {
	
}


void disabled() {}


void competition_initialize() {}


void autonomous() {}


void opcontrol() {
	auto leftTop = Motor(18, true, AbstractMotor::gearset::blue, AbstractMotor::encoderUnits::rotations);
    auto leftMiddle = Motor(19, true, AbstractMotor::gearset::blue, AbstractMotor::encoderUnits::rotations);
    auto leftBottom = Motor(20, false, AbstractMotor::gearset::blue, AbstractMotor::encoderUnits::rotations);
    auto rightTop = Motor(11, false, AbstractMotor::gearset::blue, AbstractMotor::encoderUnits::rotations);
    auto rightMiddle = Motor(12, false, AbstractMotor::gearset::blue, AbstractMotor::encoderUnits::rotations);
    auto rightBottom = Motor(13, true, AbstractMotor::gearset::blue, AbstractMotor::encoderUnits::rotations);

    std::shared_ptr<OdomChassisController> chassis =
    ChassisControllerBuilder()
        .withMotors({leftTop, leftMiddle, leftBottom}, 
                    {rightTop, rightMiddle, rightBottom}) 
        .withDimensions({AbstractMotor::gearset::blue, 5.0/3.0}, {{3.25_in, 1.294_ft}, imev5BlueTPR})
        .withSensors(leftTop, rightTop)
        .withOdometry()
        .buildOdometry();

    auto leftTrajectory = FeedForwardController(0.187, 0.04, 0.025, 2.5, 0);
    auto rightTrajectory = FeedForwardController(0.187, 0.043, 0.02, 2.5, 0);

    for(int i = 0; i < path.size(); i++) {
        double leftSpeed = leftTrajectory.step(path[i][0], path[i][2], path[i][4], 
                                               leftTop.getPosition(), leftTop.getActualVelocity());
        double rightSpeed = rightTrajectory.step(path[i][1], path[i][3], path[i][5], 
                                               rightTop.getPosition(), rightTop.getActualVelocity());
        (chassis->getModel())->tank(leftSpeed, rightSpeed);

        pros::delay(10);
    }
}